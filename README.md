simulation
==========

The same algorithm as in repo, but optimized for the simulator